<!doctype html>
<html lang="en">
  <head>
    <title>Mosya - Pencarian</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/x-icon" href="./assets/images/favicon.ico">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./assets/css/bootstrap.css">
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="./assets/css/home.css">
    <link rel="stylesheet" href="./assets/css/navigation.css">
    <link rel="stylesheet" href="./assets/css/typography.css">
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css'>
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-solid-rounded/css/uicons-solid-rounded.css'>
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-bold-rounded/css/uicons-bold-rounded.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css"/>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body class="align-items-start pt-0 flex-column">
    <!-- start navigation bar -->
    <nav class="navbar fixed-top bg-white border-bottom shadow-sm px-0">
      <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 m-auto d-flex justify-content-between align-items-center flex-column py-0 px-xl-3 px-lg-3 px-md-3 px-sm-3 px-3">
        <form method="get" action="" id="form-search" class="container-search form-search w-100 d-flex justify-content-between align-items-center" style="height: 48px;">
            <a class="navbar-brand" title="back" onclick="history.back()">
                <i class="fi fi-sr-angle-left color-black400 headline6"></i>
            </a>
            <div class="input-group-search background-black50 h-100">
                <i class="fi fi-br-search color-black200 mr-2 headline5"></i>
                <input type="text" name="search" class="bodytext1" id="input-search" placeholder="Cari mobil ...">
            </div>
            <button type="submit" hidden>search</button>
            <button type="button" data-toggle="modal" data-target="#dialogFilter" class="h-100 d-flex align-items-center justify-content-center button-search ml-3 menu-filter" style="width: 48px;">
              <i class="fi fi-rr-settings-sliders text-white headline5"></i>
            </button>
        </form>

        <div class="container-menu-tab w-100 d-flex justify-content-between mt-2">
            <button class="menu-tab-item bodytext2 flex-fill active">Semua</button>
            <button class="menu-tab-item bodytext2 flex-fill">Terbaru</button>
            <button class="menu-tab-item bodytext2 flex-fill">Harga</button>
        </div>
      </div>
    </nav>
    <!-- end navigation bar -->

    <!-- start body content -->
    <main role="main" class="container-fluid col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 pt-0 pl-0 pr-0 main-content">
    
      <!-- start content product list -->
      <div class="container-products w-100 mb-4">
        <div class="container-product d-flex justify-content-start d-flex w-100 flex-wrap px-2 py-1">
        </div>
      </div>
      <!-- end content product list -->
    </main>
    <!-- end body content -->

    <!-- start content footer -->
    <footer class="container-footer w-100 bg-white p-3 flex-row justify-content-center mb-0 col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 m-auto" style="max-height: 270px !important;">
        <p class="headline6 color-black700 semibold text-center">Download Aplikasi Mosya!</p>
        <p class="bodytext1 color-black400 text-center">Lebih mudah mencari mobil impian kamu hanya tinggal scroll dak klik klik aja.</p>
        <div class="container-footer-button d-flex justify-content-center">
          <a class="button-footer px-2" href="#">
            <img src="./assets/images/btn-google-play.png" alt="">
          </a>
          <a class="button-footer px-2" href="#">
            <img src="./assets/images/btn-app-store.png" alt="">
          </a>
        </div>

        <div class="container-footer-action d-flex justify-content-center flex-wrap mt-3">
          <a class="action-footer px-1 color-black300 bodytext2" href="#">
            Tentang Mosya |
          </a>
          <a class="action-footer px-1  color-black300 bodytext2" href="#">
            Syarat dan Ketentuan | 
          </a>
          <a class="action-footer px-1  color-black300 bodytext2" href="#">
            Pusat Bantuan
          </a>
        </div>

        <div class="container-line background-black100 w-100 my-3" style="height: 1px;"></div>

        <div class="container-footer-copyright d-flex justify-content-center flex-wrap">
          <p class="copyright color-black300 bodytext2">Copyright Â© 2022 Mosya. All rights reserved.</p>
        </div>
    </footer>
      <!-- end content footer -->

    <form action="" method="get" id="form-filter">
      <div class="modal fade" id="dialogFilter" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 fixed-bottom">
          <div class="modal-content modal-filter-content mt-auto">
              <div class="modal-header">
                <h5 class="modal-title headline6" id="staticBackdropLabel">Filter</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <i class="fi fi-br-cross headline6"></i>
                </button>
              </div>
              <div class="modal-body">
                <!-- <p class="textbody1 semibold mb-2 d-none">Merek</p>
                <div class="container-select-merk d-flex align-content-start flex-wrap flex-wrap w-100 my-2 d-none">
                  <label class="select-item select-merk-item active">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Semua" hidden checked>
                    Semua
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Audi" hidden >
                    Audi
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="BMW" hidden >
                    BMW
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Daihatsu" hidden >
                    Daihatsu
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Honda" hidden >
                    Honda
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Hyundai" hidden >
                    Hyundai
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Isuzu" hidden >
                    Isuzu
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Mercedes" hidden >
                    Mercedes
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Mitsubishi" hidden >
                    Mitsubishi
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Nissan" hidden >
                    Nissan
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Suzuki" hidden >
                    Suzuki
                  </label>
                  <label class="select-item select-merk-item ">
                    <input type="checkbox" name="merk" class="input-select-merk" value="Toyota" hidden >
                    Toyota
                  </label>
                </div> -->
                <p class="textbody1 semibold mb-2">Warna</p>
                <div class="container-select-color d-flex align-content-start flex-wrap flex-wrap w-100 my-2">
                  <label class="select-item select-color-item active">
                      <input type="checkbox" name="color" class="input-select-color" value="Semua" hidden checked>
                      Semua
                  </label>
                  <label class="select-item select-color-item">
                      <input type="checkbox" name="color" class="input-select-color" value="Hitam" hidden>
                      Hitam
                  </label>
                  <label class="select-item select-color-item">
                      <input type="checkbox" name="color" class="input-select-color" value="Silver" hidden>
                      Silver
                  </label>
                  <label class="select-item select-color-item">
                      <input type="checkbox" name="color" class="input-select-color" value="Putih" hidden>
                      Putih
                  </label>
                  <label class="select-item select-color-item">
                      <input type="checkbox" name="color" class="input-select-color" value="Biru" hidden>
                      Biru
                  </label>
                  <label class="select-item select-color-item">
                      <input type="checkbox" name="color" class="input-select-color" value="Jingga" hidden>
                      Jingga
                  </label>
                  <label class="select-item select-color-item">
                      <input type="checkbox" name="color" class="input-select-color" value="Merah" hidden>
                      Merah
                  </label>
                  <label class="select-item select-color-item">
                      <input type="checkbox" name="color" class="input-select-color" value="Gray" hidden>
                      Gray
                  </label>
                </div>
                <p class="textbody1 semibold mb-2">Tahun</p>
                <div class="container-input-year d-flex lex-column justify-content-between align-items-center mb-2">
                  <div class="input-group-search form-search background-black50 h-50 py-0 px-3">
                    <input type="number" name="tahun-awal" id="tahun-awal" maxlength="4" minlength="4" class="  bodytext1 text-center" placeholder="Tahun Awal">
                  </div>
                  <p class="bodytext1 color-black500 semibold px-2 pt-3">sd</p>
                  <div class="input-group-search form-search background-black50 h-50 py-0 px-3">
                    <input type="number" name="tahun-akhir" id="tahun-akhir" maxlength="4" minlength="4" class="  bodytext1 text-center" placeholder="Tahun Akhir">
                  </div>
                </div>
                <p class="textbody1 semibold mb-2">Bahan Bakar</p>
                <div class="container-select-fuel d-flex align-content-start flex-wrap flex-wrap w-100 my-2">
                  <label class="select-item select-fuel-item active">
                      <input type="checkbox" name="fuel" class="input-select-fuel" value="Semua" checked hidden>
                      Semua
                  </label>
                  <label class="select-item select-fuel-item">
                      <input type="checkbox" name="fuel" class="input-select-fuel" value="Bensin" hidden>
                      Bensin
                  </label>
                  <label class="select-item select-fuel-item">
                      <input type="checkbox" name="fuel" class="input-select-fuel" value="Solar" hidden>
                      Solar
                  </label>
                  <label class="select-item select-fuel-item">
                      <input type="checkbox" name="fuel" class="input-select-fuel" value="Listrik" hidden>
                      Listrik
                  </label>
                </div>
                <p class="textbody1 semibold mb-2">Batas Harga (Rp)</p>
                <div class="container-input-year d-flex lex-column justify-content-between align-items-center mb-2">
                  <div class="input-group-search form-search background-black50 h-50 py-0 px-3">
                    <input type="number" name="harga-awal" id="harga-awal" class="bodytext1 text-center" placeholder="Harga Awal">
                  </div>
                  <p class="bodytext1 color-black500 semibold px-2 pt-3">sd</p>
                  <div class="input-group-search form-search background-black50 h-50 py-0 px-3">
                    <input type="number" name="harga-akhir" id="harga-akhir" class="bodytext1 text-center" placeholder="Harga Akhir">
                  </div>
                </div>
  
              </div>
              <div class="modal-footer justify-content-around">
                <button type="reset" class="btn flex-fill button-action-filter button-action-filter-reset bg-white bodytext2 py-2 color-green500" onclick="reseltFilter()">Atur ulang</button>
                <button type="submit" class="btn flex-fill button-action-filter background-green500 bodytext2 text-white py-2">Tampilkan</button>
              </div>
          </div>
        </div>
      </div>
    </form>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="./assets/js/bootstrap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
    <script src="./assets/js/navigation.js"></script>
    <script src="./assets/js/filter.js"></script>

    <script>
      var titleEmpty = "Belum ada produk";
      var descEmpty = 'Silahkan coba lagi nanti';

      const fetchCars = () => {
        const filters = new URLSearchParams(window.location.search);
        const root = window.location.href;
        
        axios.get('assets/js/cars.json')
          .then(response => {
              var cars = response.data;
              // filter by color
              if(filters.has('color')){
                if(filters.get('color').toString() != 'Semua' && filters.get('color').toString() != ''){
                  cars = cars.filter(car => car.color == filters.get('color').toString());
                }
              }

              // filter by fuel
              if(filters.has('fuel')){
                if(filters.get('fuel').toString() != 'Semua' && filters.get('fuel').toString() != ''){
                  cars = cars.filter(car => car.fuel == filters.get('fuel').toString());
                }
              }

              // filter by merk
              if(filters.has('merk')){
                if(filters.get('merk').toString() != 'Semua' && filters.get('merk').toString() != ''){
                  cars = cars.filter(car => car.merk.toString().toLowerCase() == filters.get('merk').toString().toLowerCase());
                }
              }

              // filter by search
              if(filters.has('search') && filters.get('search').toString() != ''){
                document.getElementById('input-search').value = filters.get('search').toString();
                cars = cars.filter(car => 
                    car.model.toString().toLowerCase().includes(filters.get('search').toString().toLowerCase())
                    || car.merk.toString().toLowerCase().includes(filters.get('search').toString().toLowerCase())
                    || car.color.toString().toLowerCase().includes(filters.get('search').toString().toLowerCase())
                    || car.fuel.toString().toLowerCase().includes(filters.get('search').toString().toLowerCase()));

                titleEmpty = `Pencarian <span class="color-green500 semibold">"${filters.get('search').toString()}"</span> Tidak Ditemukan`;
                descEmpty = 'Silahkan gunakan kata kunci lain';
              }else{
                titleEmpty = "Belum ada produk";
                descEmpty = 'Silahkan coba lagi nanti';
              }

              const emptyState = `
              <div class="container-empty d-flex justify-content-center align-items-center flex-column" height="1024">
                <img src="./assets/images/car_not_found.png" alt="empty" class="img-empty h-100 mx-5 my-4" width="150">
                <div class="empty-text text-center">
                  <p class="headline6 color-black500 semibold m-0 px-3" id="title-not-found">${titleEmpty}</p>
                  <p class="bodytext2 color-black300 semibold m-0 px-3" id="desc-not-found">${descEmpty}</p>
                </div>
              </div>`;

              if(cars.length > 0){
                if(filters.has('search') && filters.get('search').toString() != ''){
                  document.querySelector('.container-product').insertAdjacentHTML('beforebegin',`
                  <p class="mb-0 bodytext1 color-black500 text-search-result semibold px-3">Menampilkan hasil pencarian <span class="color-green500">${filters.get('search')}</span></p>`)
                }else{
                  document.querySelector('.container-product').insertAdjacentHTML('beforebegin',`
                  <p class="mb-0 bodytext1 color-black500 text-search-result semibold px-3"><span class="color-green500">${cars.length}</span> mobil terkait ditemukan </p>`)
                }

                cars.map((data, i)=>{
                  document.querySelector('.container-product').insertAdjacentHTML('afterbegin',`
                  <a class="product-items w-50 flex-column" href="./product.html?id=${data.id}">
                      <div class="product-cover mb-2" style="background-image: url('${data.images[Math.floor(Math.random()*data.images.length)]}');"></div>
                      <p class="bodytext1 color-black800 semibold m-0 px-2">${data.model}</p>
                      <p class="bodytext2 color-black300 m-0 px-2">${data.year} ${data.color}</p>
                      <p class="bodytext2 semibold color-green500 m-0 py-1 px-2">Rp ${data.price}</p>
                  </a>`)
                });
                try { document.querySelector('.container-empty').remove();} catch (error) {}
              }else{
                try { document.querySelector('.text-search-result').remove();} catch (error) {}
                document.querySelector('.container-products').insertAdjacentHTML('afterbegin',emptyState);
              }
          })
          .catch(error => '');
      };

      fetchCars();
    </script>
  </body>
</html>